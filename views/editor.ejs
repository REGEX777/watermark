<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="/css/styles.css">
</head>

<body class="bg-gray-900 flex items-center justify-center min-h-screen">
    <div class="bg-gray-800 p-8 rounded-lg shadow-lg w-full max-w-2xl">
        <h1 class="text-3xl font-bold mb-6 text-center text-white">Position Your Watermark</h1>
        <div class="flex justify-center mb-6">
            <div class="relative">
                <img src="/uploads/<%= regularImage %>" alt="Regular Image" id="regularImage"
                    class="max-w-full h-auto border-2 border-gray-600">
                <img src="/uploads/<%= watermarkImage %>" alt="Watermark" id="watermarkImage"
                    class="absolute top-0 left-0 opacity-75 cursor-move border-2 border-gray-600">
            </div>
        </div>
        <form action="/editor/export" method="post" class="space-y-4">
            <input type="hidden" name="regularImage" value="<%= regularImage %>">
            <input type="hidden" name="watermarkImage" value="<%= watermarkImage %>">
            <input type="hidden" name="x" id="watermarkX">
            <input type="hidden" name="y" id="watermarkY">
            <div class="flex justify-center">
                <button type="submit"
                    class="bg-indigo-600 text-white py-2 px-4 rounded-md shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500">
                    Export Image
                </button>
            </div>
        </form>
    </div>
    <script>
        const watermarkImage = document.getElementById('watermarkImage');
        const watermarkX = document.getElementById('watermarkX');
        const watermarkY = document.getElementById('watermarkY');

        watermarkImage.onmousedown = function (event) {
            let shiftX = event.clientX - watermarkImage.getBoundingClientRect().left;
            let shiftY = event.clientY - watermarkImage.getBoundingClientRect().top;

            function moveAt(pageX, pageY) {
                watermarkImage.style.left = pageX - shiftX + 'px';
                watermarkImage.style.top = pageY - shiftY + 'px';
                watermarkX.value = parseInt(watermarkImage.style.left);
                watermarkY.value = parseInt(watermarkImage.style.top);
            }

            function onMouseMove(event) {
                moveAt(event.pageX, event.pageY);
            }

            document.addEventListener('mousemove', onMouseMove);

            watermarkImage.onmouseup = function () {
                document.removeEventListener('mousemove', onMouseMove);
                watermarkImage.onmouseup = null;
            };
        };

        watermarkImage.ondragstart = function () {
            return false;
        };
    </script>
</body>

</html>
